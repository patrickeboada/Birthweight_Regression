---
title: "Data Analysis & Visualization Project"
author: "Patrick Boada"
date: "12/1/2019"
output: 
    html_document:
    theme: spacelab
    highlight: tango
    font-size: 12pt
    font-family: Helevetica;
---

```{r}
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(pscl)
library(VIF)
library(car)
library(carData)
library(extrafont)
```


Part 1:

Load the Rdat file 'births' as an object
Prepare mode function for numeric variable analysis
```{r}
load('births.Rdat')

getmode <- function(v) {
  uni<-unique(v)
  uni[which.max(tabulate(match(v,uni)))]
}
```

Part 1: EDA & Data Cleaning
dad_age EDA
```{r}
cat('Summary of dad_age:')
cat('\n')
summary(births$dad_age)
cat('Standard Deviation of dad_age: ',sd(births$dad_age))
cat('\n')
cat('Variance of dad_age: ', var(births$dad_age))
cat('\n')
cat('Mode of dad_age: ', getmode(births$dad_age))
cat('\n')
cat('Observation and Factor Count')
cat('\n')
summary(table(births$dad_age))
cat('\n')
#cat('Na count', sum(is.na(births$dad_age)))
cat('\n')

OriginalGGdad_age <- ggplot(data=births, mapping=aes(x=births$dad_age)) + geom_histogram(color ='azure4', fill = 'lightsteelblue', bins = 45, na.rm = TRUE) + ggtitle("Histogram for dad_age") + labs(x='Years', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(OriginalGGdad_age)

#fathers age at 999 is obsuring dispersion, remove as Na value, flag to impute or drop
births$dad_age <-ifelse((births$dad_age == 999),NA,births$dad_age)
#births <- births %>% drop_na()
 
CleanGGdad_age <- ggplot(data=births, mapping=aes(x=births$dad_age)) + geom_histogram(color = 'lightblue', fill = 'azure4', bins = 45) + ggtitle("Histogram for dad_age") + labs(x='Years', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(OriginalGGdad_age)


cat('Post Data Cleaning:')
cat('Summary of dad_age:')
cat('\n')
summary(births$dad_age)
cat('\n')
cat('Na count', sum(is.na(births$dad_age)))
cat('\n')
#171 of 1000 rows are lost to data cleaning. 
#The data variable distribution is more even after cleaning.

```



mom_age EDA
```{r}
cat('Summary of mom_age:')
cat('\n')
summary(births$mom_age)
cat('Standard Deviation of mom_age: ',sd(births$mom_age))
cat('\n')
cat('Variance of mom_age: ', var(births$mom_age))
cat('\n')
cat('Mode of mom_age: ', getmode(births$mom_age))
cat('\n')
cat('Observation and Factor Count')
cat('\n')
cat('Na count', sum(is.na(births$mom_age)))
cat('\n')
summary(table(births$mom_age))

GGmom_age <- ggplot(data=births, mapping=aes(x=births$mom_age)) + geom_histogram(color = "azure3", fill ='royalblue', bins = 35) +  ggtitle("Histogram for mom_age") + labs(x='Years', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGmom_age)

#mom_age data variable appears to be clean with no outlier or anomalies

```

maturity EDA
```{r}


levels(births$maturity)
#categorical variable will need levels 
births.maturity.levels <- c('younger', 'advnced')
births$maturity <-factor(x=births$maturity, levels =births.maturity.levels, ordered = F)

cat('Summary of maturity:')
cat('\n')
summary(births$maturity)

cat('Observation and Factor Count')
cat('\n')
summary(table(births$maturity))
cat('\n')
cat('Na count', sum(is.na(births$maturity)))

#edit for categorical data

#Data variable maturity is categorical and needed to be ordered with levels involving maturity.
#There does not exists any outliers or need to clean the data any further.

GGmaturity <- ggplot(data=births, mapping=aes(x=as.factor(births$maturity))) + geom_bar(color = "lightsteelblue",fill = 'azure4', na.rm = TRUE) +  ggtitle("maturity") + labs(x='Groups', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGmaturity)
```

len_preg EDA
```{r}

cat('Summary of len_preg:')
cat('\n')
summary(births$len_preg)
cat('Standard Deviation of len_preg: ',sd(births$len_preg))
cat('\n')
cat('Variance of len_preg: ', var(births$len_preg))
cat('\n')
cat('Mode of len_preg: ', getmode(births$len_preg))
cat('\n')
cat('Observation and Factor Count')
cat('\n')
summary(table(births$len_preg))
cat('\n')
cat('Na count', sum(is.na(births$len_preg)))


OriginalGGlen_preg <- ggplot(data=births, mapping=aes(x=births$len_preg)) + geom_histogram(color = 'azure4', fill = 'lightsteelblue', bins = 30) +  ggtitle("len_preg") + labs(x='Weeks', y='Frequency')  + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(OriginalGGlen_preg)



#Small amount of outliers at 999 are obscuring the data 

births$len_preg <-ifelse((births$len_preg == 999),NA,births$len_preg)
#births <- births %>% drop_na()

cat('Summary of len_preg:')
cat('\n')
summary(births$len_preg)
cat('\n')
cat('Na count', sum(is.na(births$len_preg)))
cat('\n')



CleanGGlen_preg <- ggplot(data=births, mapping=aes(x=births$len_preg)) + geom_histogram(color = 'azure4', fill = 'lightblue', bins = 30) +  ggtitle("len_preg") + labs(x='Weeks', y='Frequency')  + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(CleanGGlen_preg)

#2  out of 1000 rows detected as 999 and change to Nas after data cleaning. 
```



is_premie EDA
```{r}

levels(births$is_premie)
births$is_premie <-droplevels(births$is_premie)
#categorical variable will need levels 
births.is_premie.levels <- c('fullterm', 'premie')
births$is_premie <-factor(x=births$is_premie, levels =births.is_premie.levels, ordered = F)


cat('Summary of is_premie:')
cat('\n')
summary(births$is_premie)
cat('Observation and Factor Count')
cat('\n')
summary(table(births$is_premie))
cat('\n')
cat('Na count', sum(is.na(births$is_premie)))

#There exists two rows where 'unknown' is given as premature status.
#Considering at least one other row is associated with more Nas, the third level unknown ought to be dropped
#births$is_premie <-ifelse((births$is_premie == 'unknown'),NA,births$is_premie)
births$is_premie[births$is_premie =='unknown'] <- NA
#births <- births %>% drop_na()
cat('Summary of is_premie:')
cat('\n')
summary(births$is_premie)

cat('Observation and Factor Count')
cat('\n')
summary(table(births$is_premie))
cat('\n')
cat('Na count', sum(is.na(births$is_premie)))

# Default plot
GGis_premie<-  ggplot(data=births, mapping=aes(x=as.factor(births$is_premie), rm.NA=T)) + geom_bar(color = "lightsteelblue",fill = 'azure4', rm.na = TRUE) +  ggtitle("is_premie") + labs(x='Groups', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGis_premie)




```


num_visits EDA
```{r}
cat('Summary of num_visits:')
cat('\n')
summary(births$num_visits)
cat('Standard Deviation of num_visits: ',sd(births$num_visits))
cat('\n')
cat('Variance of num_visits: ', var(births$num_visits))
cat('\n')
cat('Mode of num_visits: ', getmode(births$num_visits))
cat('\n')
cat('Observation and Factor Count')
cat('\n')
summary(table(births$num_visits))
cat('\n')
cat('Na count', sum(is.na(births$num_visits)))

OriginalGGnum_visits <- ggplot(data=births, mapping=aes(x=births$num_visits)) + geom_histogram(color = 'azure4', fill = 'lightsteelblue', bins = 30, na.rm = TRUE) +  ggtitle("num_visits") + labs(x='Visits', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(OriginalGGnum_visits)



#Assume that the 999 convention is being used for null values, it is possible, but unlikely to have 999 num_visits exactly.

births$num_visits <-ifelse((births$num_visits == '999'),NA,births$num_visits)
#births <- births %>% drop_na()

cat('Summary of num_visits:')
cat('\n')
summary(births$num_visits)

cat('Observation and Factor Count')
cat('\n')
summary(table(births$num_visits))
cat('\n')
cat('Na count', sum(is.na(births$num_visits)))



CleanGGnum_visits <- ggplot(data=births, mapping=aes(x=births$num_visits)) + geom_histogram(color = 'azure4', fill = 'lightblue', bins = 30, na.rm = TRUE) +  ggtitle("num_visits") + labs(x='Visits', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(CleanGGnum_visits)

#9 out of 1000 rows lost to data cleaning
```


marital EDA
```{r}
births.marital.levels <- c('married', 'unmarried')
births$marital <-factor(x=births$marital, levels =births.marital.levels, ordered = F)
cat('Summary of marital:')
cat('\n')
summary(births$marital)
cat('Observation and Factor Count')
cat('\n')
summary(table(births$marital))
cat('\n')
cat('Na count', sum(is.na(births$marital)))
cat('\n')


#2 out of 1000 rows have an unknown value, will remove and replace as Na
# <-ifelse((births$marital == 'unknown'),NA,births$marital)
#births$marital[births$marital =='unknown'] <- NA
#births <- births %>% drop_na()


cat('Summary of marital:')
cat('\n')
summary(births$marital)
cat('\n')
cat('Observation and Factor Count')
cat('\n')
summary(table(births$marital))
cat('\n')
cat('Na count', sum(is.na(births$marital)))

GGmarital<-  ggplot(data=births, mapping=aes(x=as.factor(births$marital), rm.na=T)) + geom_bar(color = "lightsteelblue",fill = 'azure4') +  ggtitle("marital") + labs(x='Groups', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGmarital)

```


mom_wt_gain EDA
```{r}
cat('Summary of mom_wt_gain:')
cat('\n')
summary(births$mom_wt_gain)
cat('Standard Deviation of mom_wt_gain: ',sd(births$mom_wt_gain))
cat('\n')
cat('Variance of mom_wt_gain: ', var(births$mom_wt_gain))
cat('\n')
cat('Mode of mom_wt_gain: ', getmode(births$mom_wt_gain))
cat('\n')
cat('Observation and Factor Count')
cat('\n')
summary(table(births$mom_wt_gain))
cat('\n')
cat('Na count', sum(is.na(births$mom_wt_gain)))


OriginalGGnum_mom_wt_gain <- ggplot(data=births, mapping=aes(x=births$mom_wt_gain)) + geom_histogram(color = 'azure4', fill = 'lightsteelblue', bins = 30, na.rm = TRUE) +  ggtitle("mom_wt_gain") + labs(x='lbs', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(OriginalGGnum_mom_wt_gain)



#Data cleaning: possible for the mother to have 0 weight gain considering the mother may be advised to diet to higher weight or obesity. Remove 999 values.

births$mom_wt_gain[births$mom_wt_gain == 999] <- NA

#births <- births %>% drop_na()

cat('Summary of marital:')
cat('\n')
summary(births$mom_wt_gain)
cat('Standard Deviation of mom_wt_gain: ',sd(births$mom_wt_gain))
cat('\n')
cat('Variance of mom_wt_gain: ', var(births$mom_wt_gain))
cat('\n')
cat('Mode of mom_wt_gain: ', getmode(births$mom_wt_gain))
cat('\n')
cat('Observation and Factor Count')
cat('\n')
summary(table(births$mom_wt_gain))
cat('\n')
cat('Na count', sum(is.na(births$mom_wt_gain)))



CleanGGmom_wt_gain <- ggplot(data=births, mapping=aes(x=births$mom_wt_gain)) + geom_histogram(color = 'azure4', fill = 'lightblue', bins = 30, na.rm = TRUE) +  ggtitle("mom_wt_gain") + labs(x='pounds', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(CleanGGmom_wt_gain)



```


bwt EDA
```{r}
cat('Summary of marital:')
cat('\n')
summary(births$bwt)
cat('Standard Deviation of bwt: ',sd(births$bwt))
cat('\n')
cat('Variance of bwt: ', var(births$bwt))
cat('\n')
cat('Mode of bwt: ', getmode(births$bwt))
cat('\n')
cat('Observation and Factor Count')
cat('\n')
summary(table(births$bwt))
cat('\n')
cat('Na count', sum(is.na(births$bwt)))


GGbwt <- ggplot(data=births, mapping=aes(x=births$bwt)) + geom_histogram(color = 'azure4', fill = 'royalblue', bins = 30) +  ggtitle("bwt") + labs(x='pounds', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGbwt)


```

low_bwt EDA
```{r}

births.low_bwt.levels <- c('low', 'notlow')
births$low_bwt <-factor(x=births$low_bwt, levels =births.low_bwt.levels, ordered = F)
cat('Summary of low_bwt:')
cat('\n')
summary(births$low_bwt)
cat('Observation and Factor Count')
cat('\n')
summary(table(births$low_bwt))
cat('\n')
cat('Na count', sum(is.na(births$low_bwt)))



GGlow_bwt<-  ggplot(data=births, mapping=aes(x=as.factor(births$low_bwt), rm.na=T)) + geom_bar(color = "lightsteelblue",fill = 'azure4') +  ggtitle("low_bwt") + labs(x='Groups', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGlow_bwt)

#data is clean, no additional editing needed.
```

sex EDA
```{r}

births.sex.levels <- c('female', 'male')
births$sex <-factor(x=births$sex, levels =births.sex.levels, ordered = F)
cat('Summary of sex:')
cat('\n')
summary(births$sex)
cat('Observation and Factor Count')
cat('\n')
summary(table(births$sex))
cat('\n')
cat('Na count', sum(is.na(births$sex)))
cat('Summary of sex:')
cat('\n')
summary(births$sex)

GGsex<-  ggplot(data=births, mapping=aes(x=as.factor(births$sex), rm.na=T)) + geom_bar(color = "lightsteelblue",fill = 'azure4') +  ggtitle("sex") + labs(x='Groups', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGsex)
```

smoke EDA
```{r}

births.smoke.levels <- c('nonsmoker', 'smoker')
births$smoke <-factor(x=births$smoke, levels =births.smoke.levels, ordered = F)


cat('Summary of smoke:')
cat('\n')
summary(births$smoke)
cat('Observation and Factor Count')
cat('\n')
summary(table(births$smoke))
cat('\n')
cat('Na count', sum(is.na(births$smoke)))

#births$smoke <-ifelse((births$smoke == 'unknown'),NA,births$smoke)
#births$smoke[births$smoke == 'unknown'] <- NA

#births <- births %>% drop_na()
GGsmoke<-  ggplot(data=births, mapping=aes(x=as.factor(births$smoke), rm.na=T)) + geom_bar(color = "lightsteelblue",fill = 'azure4') +  ggtitle("smoke") + labs(x='Groups', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGsmoke)
```


mom_white EDA
```{r}
levels(births$mom_white)
births.mom_white.levels <- c('nonwhite', 'white')
births$mom_white <-factor(x=births$mom_white, levels =births.mom_white.levels, ordered = F)

cat('Summary of mom_white:')
cat('\n')
summary(births$mom_white)
cat('Observation and Factor Count')
cat('\n')
summary(table(births$mom_white))
cat('\n')
cat('Na count', sum(is.na(births$mom_white)))


#births$mom_white <-ifelse((births$mom_white == 'unknown'),NA,births$mom_white)
#births$mom_white[births$mom_white == 'unknown'] <- NA
#births <- births %>% drop_na()
GGmom_white<-  ggplot(data=births, mapping=aes(x=as.factor(births$mom_white), rm.na=T)) + geom_bar(color = "lightsteelblue",fill = 'azure4', rm.na = TRUE) +  ggtitle("mom_white") + labs(x='Groups', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGmom_white)
```


mom_age_level EDA

```{r}

births.mom_age_level.levels <- c('teens', 'early20s', 'late20s','early30s','35+')
births$mom_age_level <-factor(x=births$mom_age_level, levels =births.mom_age_level.levels, ordered = F)

cat('Summary of mom_age_level:')
cat('\n')
summary(births$mom_age_level)
cat('Observation and Factor Count')
cat('\n')
summary(table(births$mom_age_level))
cat('\n')
cat('Na count', sum(is.na(births$mom_age_level)))


GGmom_age_level<-  ggplot(data=births, mapping=aes(x=as.factor(births$mom_age_level), rm.na=T)) + geom_bar(color = "lightsteelblue",fill = 'azure4') +  ggtitle("mom_age_level") + labs(x='Groups', y='Frequency') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGmom_age_level)
```



Data is clean: all dichotomous variables have been restored by removing 'unknown', all 999 outliers have been removed, all other data appears to be logical with a medical standard. After cleaning, varying by 14 column variables, 781 rows of 1000 remain for model fitting and multivariate relations.
```{r}
births <- births %>% drop_na()

cat('Summary of Cleaned Data:')
cat('\n')

summary(births)
cat('Dimensions of Cleaned Data:')
cat('\n')
dim(births)

```


Birthweight Bivariate Relationships
```{r}


GGmom_ageANDbwt <- ggplot(data=births, mapping=aes(births$mom_age), births$bwt) + geom_point( aes(y=births$bwt, x = births$mom_age),color = 'royalblue1', fill = 'darkturquoise') +  ggtitle("Mother's Age as a factor in Birthweight") + labs(x='age', y='Birthweight (pounds)') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGmom_ageANDbwt )



GGlen_pregANDbwt <- ggplot(data=births, mapping=aes(births$len_preg, births$bwt)) + geom_jitter( aes(y=births$bwt, x = births$len_preg),color = 'royalblue3', fill = 'royalblue4') +  ggtitle("Length of Pregancy as a factor of Birthweight") + labs(x='Weeks', y='Birthweight (pounds)') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGlen_pregANDbwt)



GGmom_age_levelANDbwt <- ggplot(data=births, mapping=aes(x=births$mom_age_level, y=births$bwt))  + geom_boxplot(fill = 'royalblue4', color = 'royalblue3') +  ggtitle("Mother's Age Level as a factor of Birthweight") + labs(x='Weeks', y='Birthweight (pounds)') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank())
plot(GGmom_age_levelANDbwt)




```

Mother's Age as a factor in Birthweight shows that the highest birthweight achieved was by an individual ~32 years old, and the lowest birthweight ~2 pounds was shared among ages less than 20 to 40 years old. Moreover, we see that regardless of age there is a high frequency of babies born with a birthweight between 6 to 9 pounds.

Length of Pregnancy as a factor of Birthweight shows that the highest birthweight achieved was from a gestation length above 40 weeks. The lowest birthweights are associated with gestation lengths less than 25 weeks. Moreover, we see a high clustering frequency of babies between 35 to 40 weeks with a birthweight ranging from 6 to 10 pounds.

Mother's Age Level as a factor of Birthweight shows that median values are all nearly shared among age groups around 7.5 pounds. All age groups demonstrate an occurrence of low minimum values for birthweight that are less than 3 pounds However it may be observed that late 20s has the tightest IQR among all groups, with the highest relative median as well. Nevertheless, the highest maximum birthweight was rendered from a patient from age group early30s.




Birthweight Trivariate
```{r}

GGmom_age_bwt_marital <- ggplot(data=births, mapping=aes(x =births$mom_age, y = births$bwt, col = marital)) + geom_point(na.rm = T) +  ggtitle("Mother's Age & Marital Status as a factor in Birthweight") + labs(x='age', y='Birthweight (pounds)') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGmom_age_bwt_marital )



GGmom_age_bwt_wtgain <- ggplot(data=births, mapping=aes(x =births$mom_age, y = births$bwt, col = mom_wt_gain))  + geom_jitter(na.rm = T)  + labs(fill ='maternal weight gain') + ggtitle("Mother's Age & Weight Gain as a factor in Birthweight") + labs(x='age', y='Birthweight (pounds)') + theme_bw() + theme(
  
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGmom_age_bwt_wtgain )


GGlen_preg_bwt_momagelevel <- ggplot(data=births, mapping=aes(x =births$len_preg, y = births$bwt, col = mom_age_level))  + geom_jitter(height = 0.5, width = 0.25, na.rm = T)  + labs(fill ='Length of Pregnancy') + ggtitle("Pregnancy Length & Age Level as a factor in Birthweight") + labs(x='Weeks', y='Birthweight (pounds)') + theme_bw() + theme(
  
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGlen_preg_bwt_momagelevel )

GGlen_preg_bwt_momage <- ggplot(data=births, mapping=aes(x =births$len_preg, y = births$bwt, col = mom_age))  + geom_jitter(height = 0.5, width = 0.25, na.rm = T)  + labs(fill ='Length of Pregnancy') + ggtitle("Pregnancy Length & Mother's Age as a factor in Birthweight") + labs(x='Weeks', y='Birthweight (pounds)') + theme_bw() + theme(
  
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGlen_preg_bwt_momage )


GGlen_preg_bwt_smoke <- ggplot(data=births, mapping=aes(x =births$len_preg, y = births$bwt, col = smoke))  + geom_jitter(height = 0.5, width = 0.25, na.rm = T)  + labs(fill ='Length of Pregnancy') + ggtitle("Pregnancy Length & Smoking as a factor in Birthweight") + labs(x='Weeks', y='Birthweight (pounds)') + theme_bw() + theme(
  
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGlen_preg_bwt_smoke)

GGlen_preg_bwt_white <- ggplot(data=births, mapping=aes(x =births$len_preg, y = births$bwt, col = mom_white))  + geom_jitter(height = 0.5, width = 0.25, na.rm = T)  + labs(fill ='Length of Pregnancy') + ggtitle("   Pregnancy Length & Racial Status as a factor in Birthweight") + labs(x='Weeks', y='Birthweight (pounds)') + theme_bw() + theme(
  
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGlen_preg_bwt_white)


GGlen_preg_bwt_visits <- ggplot(data=births, mapping=aes(x =births$num_visits, y = births$bwt, col = len_preg))  + geom_jitter(height = 0.5, width = 0.25, na.rm = T)  + ggtitle("Number of visits & Pregnancy Length as a factor in Birthweight") + labs(x='Amount of Visits', y='Birthweight (pounds)') + theme_bw() + theme(
  
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank()) 
plot(GGlen_preg_bwt_visits)

GGis_premieBwtSmoke <-ggplot(births, aes(x=births$is_premie, y=births$bwt, color = smoke)) + geom_boxplot(aes(y=births$bwt, x = births$is_premie), fill = 'gray90') + ggtitle("Prematurity & Smoking Status as a factor of Birthweight") + labs(x='Groups', y='Birthweight (pounds)') + theme_bw() + theme(
    plot.title = element_text(hjust = 0.5),
    text=element_text(size=10,  family="Orbitron Light", face ='plain'),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank())
plot(GGis_premieBwtSmoke)



```
Mother’s Age & Marital Status as a factor in Birthweight depicts the amount of weight of married mothers compared to single mothers. The plot demonstrates that the highest weights were rendered from married woman. Lower birthweight does exist in both groups.  Moreover, we see a majority of married mothers in the sample.

Mother's Age & Weight Gain as a factor in Birthweight depicts the net gained weight of women, with respect to the infant's birthweight and the mother's age. The plot demonstrates that the highest weight gained in mothers resulted in baby most frequently above ~7.5 pounds. Lower weight gain does exist on both sides of the birthweight range. However, a majority of incidents of lower weight gained occur in babies born below 6 pounds and predominantly in babies born below 3 pounds.

Pregnancy Length & Mother's Age Level as a factor in Birthweight demarcates the frequency of age levels with respect to gestation length and birthweight. One may observe that there is a high frequency of infants born between 6-11 pounds predominantly from 35+. Furthermore, there is not one single age level that overwhelming composes lower birthweights. However, we do see higher birthweights achieved from mothers in early30s with a gestation length between 35-40 weeks.

Pregnancy Length & Mother's Age as a factor in Birthweight emphasizes the age of mothers with respect to their gestation length and birthweight of the infant. The plot confirms that babies with a gestation length ranging between 35 - 40 weeks is composed of mothers ~35 years old. Moreover, there are not many incidents of mothers above 40 with gestations length shorter than 30 weeks or with babies less than 6 pounds.

Pregnancy Length & Smoking as a factor in Birthweight separates nonsmoking mothers with respect to gestation length and birthweight. Undisputedly, one may observe that there exists a high frequency of babies born with birthweights equal to or greater than 7.5 pounds with gestation ranging between 35-42 weeks from nonsmoking mothers. Although smoking mothers do exist along the 40-45-week spectrum of gestation, their birthweights do not exceed ~7.5 pounds. Alternatively, the occurrence of shorter gestation length and lower birthweight is not only exhibited in smoking mothers. In this sample (that has a larger amount of nonsmoking mothers), we see a high proportion of nonsmoking mothers experience shorter gestation and lower birthweight compared to smoking mothers.

Pregnancy Length & Mother's Racial Status as a factor in Birthweight highlights European descent compared to all other ethnic classes. In the plot one can see that a majority of the sample is derived of white mothers. Although lower birthweights and lower gestation length is shared among ethnic groups one can observe that there exists a higher amount of high birthweights and longer gestation in white mothers
compared to nonwhite mothers.

Number of visits & Pregnancy Length as factor in Birthweight demarcates the length of pregnancy with respect to amount of visits for resulting birthweight. The highest occurrence of visits is 10 -20. Among this range the length of pregnancy is ~40 weeks and above for a birthweight equal or higher than ~7.5 pounds. Naturally, we see that the lowest gestation length and birthweight relates to the lowest amount of visits. Moreover, that the highest number of visits corresponds to the highest gestation length. 

Prematurity & Smoking Status as a factor of Birthweight shows the distinction of premature birthweight with relation to mother's smoking status. In smoking mothers’ median values of birthweight are both lower than their nonsmoking counterparts. Moreover, fullterm pregnancy of a smoking mother is ~7.5 pounds, whereas a premature pregnancy of a smoking mother is ~5 pounds. Nonsmoking mothers of premature babies have a wide range when compared to other groups. Fullterm pregnancy medians are similar between smoking classes, the range of birthweight of smoking fullterm pregnancies is much lower nonsmoking fullterm pregnancies.
he range of birthweight of smoking fullterm pregnancies is much lower nonsmoking fullterm pregnancies.





 Numeric DataFrame for Spearman Correlation
```{r}
births_numeric <- births[,c(1:14)]

births_numeric$maturity <- as.numeric(births_numeric$maturity ) 
births_numeric$is_premie <- as.numeric(births_numeric$is_premie )
births_numeric$marital <- as.numeric(births_numeric$marital )
births_numeric$low_bwt <- as.numeric(births_numeric$low_bwt )
births_numeric$sex <- as.numeric(births_numeric$sex )
births_numeric$smoke <- as.numeric(births_numeric$smoke )
births_numeric$mom_white <- as.numeric(births_numeric$mom_white )
births_numeric$mom_age_level <- as.numeric(births_numeric$mom_age_level)
```







Correlations Assessment
```{r}
cor(births_numeric, use = 'pairwise.complete.obs', method= 'spearman')
```

Flagged correlations to observe for extremely high correlation:

len_preg and low_bwt 0.394272207
bwt and len_preg 0.415578278
maturity and dad_age 0.485342656
is_premie and bwt -0.413940315

is_premie and low_bwt -0.569065432
bwt and low_bwt 0.501145575
mom_age  and dad_age 0.792775401

maturity and mom_age 0.618845584

dad_age and mom_age_level 0.77022225
mom_age and mom_age_level 0.974144738 



Inferential Statistics:
```{r}
#If the ratio of the larger sample standard deviation to the smaller sample standard deviation is less than 2, one can assume equal variances
library('pwr')

t.test(births_numeric$bwt ~births_numeric$low_bwt)

t.test(births_numeric$len_preg ~births_numeric$low_bwt)
t.test(births_numeric$is_premie ~births_numeric$low_bwt)

t.test(births_numeric$bwt ~births_numeric$mom_white)
t.test(births_numeric$bwt ~births_numeric$sex)

#all means are not equal, each group is distinct from one another


chisq.test(table(births_numeric$is_premie, births_numeric$low_bwt))
#p-value < 2.2e-16, strong correlation

births_numeric %>% count(low_bwt)
#1: 111, 2:889
pwr.t2n.test(n1=111, n2=889, d=0.2, sig.level = 0.5)
#power is below threshold

births_numeric %>% count(sex)
#1: 503, 2: 497
pwr.t2n.test(n1=503, n2=497, d=0.2, sig.level = 0.5)

births_numeric %>% count(mom_white)
#1: 284, 2: 714
pwr.t2n.test(n1=284, n2=714, d=0.2, sig.level = 0.5)



```


Linear Model: bwt as a response variable of an initial set of 12 predictor variables
remove low_bwt, since it is derived from bwt, remove is premie since it a dichotomized version of low_bwt, remove mom_age_level since it is derived from mom_age
```{r}
LinearFitbwt <- lm(bwt ~ dad_age + mom_age + maturity + len_preg + num_visits + marital + mom_wt_gain + sex + smoke + mom_white , births)
plot(LinearFitbwt)
summary(LinearFitbwt)

```

Residual standard error: 1.065 on 770 degrees of freedom
Multiple R-squared:  0.4568,	Adjusted R-squared:  0.4498 
F-statistic: 64.76 on 10 and 770 DF,  p-value: < 2.2e-16

remove: mom_age (Pr(>|t|)  0.66958)

```{r}

LinearFitbwt1 <- lm(bwt~(dad_age + maturity + len_preg + num_visits + marital + mom_wt_gain  + sex + smoke + mom_white),data= births)
plot(LinearFitbwt1)
summary(LinearFitbwt1)


```

Residual standard error: 1.065 on 771 degrees of freedom
Multiple R-squared:  0.4567,	Adjusted R-squared:  0.4503 
F-statistic: 72.01 on 9 and 771 DF,  p-value: < 2.2e-16

Remove maturity (Pr(>|t|) 0.87893)



```{r}
LinearFitbwt2 <- lm(bwt~(dad_age + len_preg + num_visits + marital + mom_wt_gain  + sex + smoke + mom_white),data= births)
plot(LinearFitbwt2)
summary(LinearFitbwt2)

```

Residual standard error: 1.064 on 772 degrees of freedom
Multiple R-squared:  0.4567,	Adjusted R-squared:  0.451 
F-statistic: 81.11 on 8 and 772 DF,  p-value: < 2.2e-16

remove: num_visits (Pr(>|t|) 0.54149)


```{r}
LinearFitbwt3 <- lm(bwt~(dad_age + len_preg + marital + mom_wt_gain  + sex + smoke + mom_white),data= births)
plot(LinearFitbwt3)
summary(LinearFitbwt3)

```
Residual standard error: 1.064 on 773 degrees of freedom
Multiple R-squared:  0.4564,	Adjusted R-squared:  0.4515 
F-statistic: 92.72 on 7 and 773 DF,  p-value: < 2.2e-16


remove: dad_age (Pr(>|t|)  0.26109)


```{r}
LinearFitbwt4 <- lm(bwt~(len_preg + marital + mom_wt_gain  + sex + smoke + mom_white),data= births)
plot(LinearFitbwt4)
summary(LinearFitbwt4)
```
Residual standard error: 1.064 on 774 degrees of freedom
Multiple R-squared:  0.4555,	Adjusted R-squared:  0.4513 
F-statistic: 107.9 on 6 and 774 DF,  p-value: < 2.2e-16

All predictor variables are have p values below a cutoff of 0.05.
The final linear model accounts for variation in bwt 45.13% of time.
Although there is a curve to the fitted line, residuals are more randomly and evenly distributed.


```{r}

vif(LinearFitbwt4)

```




Logistical Model: low_bwt as a response variable of a set of predictor variables


drop bwt, is_premie as a multicolinearity for response variable. Also drop mom_age_level as it is derived from mom_age


```{r}

#for glm, drop variable columns that have corr > .5
glmModel_lowbwt <- glm(low_bwt  ~ dad_age + mom_age + maturity + len_preg + num_visits + marital + mom_wt_gain + sex + smoke + mom_white, family = binomial() , data= births)
plot(glmModel_lowbwt)
summary(glmModel_lowbwt)

pR2(glmModel_lowbwt)
vif(glmModel_lowbwt)
exp(cbind(OR=coef(glmModel_lowbwt), confint(glmModel_lowbwt)))

```

Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 256.72  on 770  degrees of freedom
AIC: 278.72
remove  num_visits  Pr(>|z|)  0.7681





McFadden and r2CU scores are acceptable to move forward without examining for additional multicollinearity

```{r}

glmModel_lowbwt1 <- glm(low_bwt  ~ dad_age + mom_age + maturity + len_preg + marital + mom_wt_gain + sex + smoke + mom_white, family = binomial() , data= births)
plot(glmModel_lowbwt1)
summary(glmModel_lowbwt1)

pR2(glmModel_lowbwt1)
vif(glmModel_lowbwt1)
exp(cbind(OR=coef(glmModel_lowbwt1), confint(glmModel_lowbwt1)))

```
All VIF scores < 10, no inherent multicollinearity observed
remove: sex Pr(>|z|) 0.6301  

```{r}

glmModel_lowbwt2 <- glm(low_bwt  ~ dad_age + mom_age + maturity + len_preg + marital + mom_wt_gain + smoke + mom_white, family = binomial() , data= births)
plot(glmModel_lowbwt2)
summary(glmModel_lowbwt2)

pR2(glmModel_lowbwt2)
vif(glmModel_lowbwt2)
exp(cbind(OR=coef(glmModel_lowbwt2), confint(glmModel_lowbwt2)))

```

Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 257.04  on 772  degrees of freedom
AIC: 275.04
remove: mom_white Pr(>|z|) 0.617


```{r}
glmModel_lowbwt3 <- glm(low_bwt  ~ dad_age + mom_age + maturity + len_preg + marital + mom_wt_gain + smoke, family = binomial() , data= births)
plot(glmModel_lowbwt3)
summary(glmModel_lowbwt3)

pR2(glmModel_lowbwt3)
vif(glmModel_lowbwt3)
exp(cbind(OR=coef(glmModel_lowbwt3), confint(glmModel_lowbwt3)))
```

Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 257.29  on 773  degrees of freedom
AIC: 273.29
remove: dad_age Pr(>|z|) 0.4079

```{r}
glmModel_lowbwt4 <- glm(low_bwt  ~  mom_age + maturity + len_preg + marital + mom_wt_gain + smoke, family = binomial() , data= births)
plot(glmModel_lowbwt4)
summary(glmModel_lowbwt4)

pR2(glmModel_lowbwt4)
vif(glmModel_lowbwt4)
exp(cbind(OR=coef(glmModel_lowbwt4), confint(glmModel_lowbwt4)))

```

Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 257.95  on 774  degrees of freedom
AIC: 271.95

remove: mom_age Pr(>|z|)  0.4914


```{r}
glmModel_lowbwt5 <- glm(low_bwt  ~ maturity + len_preg + marital + mom_wt_gain + smoke, family = binomial() , data= births)
plot(glmModel_lowbwt5)
summary(glmModel_lowbwt5)

pR2(glmModel_lowbwt5)
vif(glmModel_lowbwt5)
exp(cbind(OR=coef(glmModel_lowbwt5), confint(glmModel_lowbwt5)))
```

Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 258.43  on 775  degrees of freedom
AIC: 270.43
remove: maturity Pr(>|z|)  0.3161



```{r}
glmModel_lowbwt6 <-glm(low_bwt  ~ len_preg + marital + mom_wt_gain + smoke, family = binomial() , data= births)
plot(glmModel_lowbwt6)
summary(glmModel_lowbwt6)

pR2(glmModel_lowbwt6)
vif(glmModel_lowbwt6)
exp(cbind(OR=coef(glmModel_lowbwt6), confint(glmModel_lowbwt6)))

```
Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 259.39  on 776  degrees of freedom
AIC: 269.39

remove: marital Pr(>|z|)  0.137 

```{r}

glmModel_lowbwt6 <- glm(low_bwt  ~ len_preg + mom_wt_gain + smoke, family = binomial() , data= births)
plot(glmModel_lowbwt6)
summary(glmModel_lowbwt6)

pR2(glmModel_lowbwt6)
vif(glmModel_lowbwt6)
exp(cbind(OR=coef(glmModel_lowbwt6), confint(glmModel_lowbwt6)))
```

Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 261.54  on 777  degrees of freedom
AIC: 269.54
remove: mom_wt_gain Pr(>|z|) 0.0853


```{r}
glmModel_lowbwt7 <- glm(low_bwt  ~ len_preg + smoke, family = binomial() , data= births)
plot(glmModel_lowbwt7)
summary(glmModel_lowbwt7)

pR2(glmModel_lowbwt7)
vif(glmModel_lowbwt7)
exp(cbind(OR=coef(glmModel_lowbwt7), confint(glmModel_lowbwt7)))
```
Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 264.66  on 778  degrees of freedom
AIC: 270.66
remove: smoke 0.0844 Pr(>|z|)  


```{r}
glmModel_lowbwt8 <- glm(low_bwt ~ len_preg, family = binomial() , data= births)
plot(glmModel_lowbwt8)
summary(glmModel_lowbwt8)

pR2(glmModel_lowbwt8)
exp(cbind(OR=coef(glmModel_lowbwt8), confint(glmModel_lowbwt8)))
```
glm plot indicates of discrete response variable

Null deviance: 480.43  on 780  degrees of freedom
Residual deviance: 267.43  on 779  degrees of freedom
AIC: 271.43

The final model has one predictor variable with a p value well below the 0.05 cutoff





